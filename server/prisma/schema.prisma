generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider     = "mysql"
  url          = env("DATABASE_URL")
  relationMode = "prisma"
}

model Admin {
  id           String   @id @default(uuid())
  username     String
  email        String
  password     String?
  authType     AuthType
  refreshToken String?
  createdAt    DateTime @default(now())
  updatedAt    DateTime @default(now()) @updatedAt()
}

model Component {
  id       String @id @default(uuid())
  name     String
  category String
  html     String @db.Text
  css      String @db.Text

  createdAt DateTime @default(now())
  updatedAt DateTime @default(now()) @updatedAt()

  @@index([id])
  @@index([name])
  @@index([category])
}

model Link {
  id        String  @id @default(uuid())
  label     String
  href      String?
  target    String?
  rel       String?
  active    Boolean @default(true)

  sectionId String
  section   Section @relation(fields: [sectionId], references: [id])

  order Int @default(0)

  parentId String?
  parent   Link?   @relation("SubLinks", fields: [parentId], references: [id], onDelete: NoAction, onUpdate: NoAction)
  children Link[]  @relation("SubLinks")

  @@index([parentId])
  @@index([sectionId])
  @@index([order])
}

model Section {
  id         String      @id @default(uuid())
  type       SectionType
  mode       SectionMode @default(NORMAL)
  links      Link[]
  customHtml String?     @db.Text
  customCss  String?     @db.Text

  profile String?
  logo String?
  tabsPlacement TabsPlacement? @default(center)

  createdAt  DateTime    @default(now())
  updatedAt  DateTime    @updatedAt
}

enum SectionType {
  HEADER
  FOOTER
}

enum SectionMode {
  NORMAL
  CUSTOM
}

model Page {
  id       String @id @default(uuid())
  title    String
  slug     String @unique
  html     String @db.Text
  css      String @db.Text
  status   String
  metadata Json?

  createdAt DateTime @default(now())
  updatedAt DateTime @default(now()) @updatedAt()

  @@index([id])
  @@index([slug])
}

model Blog {
  id         String   @id @default(uuid())
  title      String
  slug       String   @unique
  content    Json @db.Json
  featuredImage String?
  status     String
  seoTitle   String
  seoDescription String
  metaImage  String?

  createdAt  DateTime @default(now())
  updatedAt  DateTime @default(now()) @updatedAt()

  @@index([id])
  @@index([slug])
}

enum AuthType {
  oauth
  manual
}

enum TabsPlacement {
  left
  center
  right
}